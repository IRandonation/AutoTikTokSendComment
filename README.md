# 抖音直播自动弹幕助手 (Douyin Live Auto Sender) v2.0
> 📱 **新增浏览器插件模式**：现已支持油猴脚本 (Tampermonkey)，支持 Windows/macOS/Linux/Android 等全平台使用！

这是一个基于 Python + Selenium 的跨平台自动化工具，同时提供**油猴脚本 (UserScript)** 版本，用于在抖音直播间自动发送指定内容的弹幕。

**v2.0 新特性：**
*   🌐 **全平台支持 (New!)**：新增 Tampermonkey 油猴脚本，无需安装 Python，只要有浏览器就能用 (支持手机端浏览器)。
*   🔄 **多条弹幕循环**：支持输入多行弹幕，程序会按顺序循环发送。
*   🎲 **随机间隔**：发送间隔增加 ±20% 的随机波动，模拟真人操作，降低风控风险。
*   🚀 **插队发送**：可以在循环发送过程中，随时手动插入一条立即发送的弹幕。
*   ❤️ **快速点赞**：一键模拟点击屏幕进行点赞（默认10次）。

## 📋 功能特点

*   **图形化界面**：无需修改代码，直接在界面上输入参数。
*   **跨平台支持**：自动管理 Chrome 驱动，支持 Windows 和 macOS。
*   **自动登录保持**：使用本地 User Data 目录，一次登录后可保持登录状态。
*   **防检测机制**：集成基本的 Selenium 反爬虫屏蔽参数。
*   **智能标签页切换**：自动识别并切换到最新的直播间标签页。

## 🌐 浏览器插件模式 (全平台通用)

无需安装 Python 环境，只需安装浏览器扩展即可使用。支持 Chrome, Edge, Firefox, Safari 以及 Android 上的 KiWi/Yandex 浏览器。

### 1. 安装油猴插件
如果你还没有安装脚本管理器，请先安装：
*   **Chrome/Edge**: 安装 [Tampermonkey](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
*   **Firefox**: 安装 [Tampermonkey](https://addons.mozilla.org/zh-CN/firefox/addon/tampermonkey/)
*   **Android**: 使用 KiWi Browser 或 Yandex Browser 安装 Tampermonkey 扩展。

### 2. 安装脚本
1.  找到本项目中的 `douyin_auto_sender.user.js` 文件。
2.  在浏览器中打开 Tampermonkey 管理面板 -> "添加新脚本"。
3.  将文件内容复制进去并保存。
4.  或者直接将文件拖入浏览器窗口进行安装。

### 3. 使用方法
1.  打开任意抖音直播间网页 (live.douyin.com 或 douyin.com)。
2.  页面右侧会出现一个悬浮面板 "🤖 抖音自动弹幕"。
3.  设置间隔、输入弹幕内容，点击 "开始运行" 即可。

---

## 🛠️ Python 桌面版依赖安装

本项目使用 `uv` 进行包管理。首次运行时会自动建立虚拟环境并安装依赖。

1.  **确保已安装 Google Chrome 浏览器**。
2.  **确保已安装 `uv`** (Python 包管理器)。

## 🚀 一键运行 (推荐)

无需手动输入命令，直接使用以下脚本即可自动配置环境并运行：

### Windows 用户
双击运行项目目录下的 **`run_win.bat`** 脚本。
*   它会自动检测并安装 `uv` 环境。
*   自动安装所有依赖并启动程序。

### macOS / Linux 用户
在终端中运行项目目录下的 **`run_mac.sh`** 脚本：

```bash
# 赋予执行权限（仅需一次）
chmod +x run_mac.sh

# 运行
./run_mac.sh
```

---

## 💻 命令行运行 (高级)

如果你熟悉命令行，也可以使用传统方式：

1.  **启动程序**

    在项目根目录下打开终端，运行：

    ```bash
    uv run main.py
    ```

### 2. 使用说明

程序启动后会出现一个图形界面窗口，操作步骤如下：

#### 第一步：打开浏览器
1.  **直播间链接（可选）**：
    *   你可以粘贴链接，也可以留空。
2.  点击 **"1. 打开浏览器"**。
    *   如果留空链接，会打开抖音主页。请手动登录并搜索/点击进入你想要互动的直播间。
    *   **注意**：请确保浏览器切换到了直播间页面，且能看到底部的聊天输入框。

#### 第二步：自动发送配置
1.  **弹幕列表**：
    在中间的文本框中输入你想发送的弹幕，**一行一条**。程序会按顺序一条接一条地循环发送。
2.  **发送间隔**：
    设置基准间隔时间（例如 10 秒）。实际发送时，会在 8~12 秒之间随机波动。
3.  点击 **"2. 开始循环发送"** 启动任务。

#### 其他功能
*   **插队弹幕**：
    在底部 "手动操作" 区域，输入内容并点击 **"立即发送"**。这不会打断正在进行的循环任务。
*   **快速点赞**：
    点击 **"快速点赞 (10次)"**，程序会模拟鼠标在视频区域快速点击。

## 📝 实现思路与技术细节

### 1. 核心架构
*   **GUI (tkinter)**: 使用 Python 内置的 tkinter 库构建界面，负责接收用户输入和显示日志。
*   **自动化 (Selenium)**: 负责控制浏览器行为。
*   **多线程 (threading)**: 所有的自动化操作、定时任务、点赞任务都在独立的线程中运行，互不干扰，且不阻塞 GUI。

### 2. 关键技术点

*   **模拟真人**: 通过 `random.uniform` 实现时间间隔的随机波动。
*   **标签页管理**: 每次操作前检查 `driver.window_handles`，确保操作的是用户当前观看的标签页。
*   **元素定位**: 使用多重 XPath 策略 (`textarea`, `contenteditable` 等) 兼容不同版本的抖音网页结构。
*   **点赞原理**: 使用 Selenium 的 `ActionChains` 模拟鼠标在视频容器 (`xgplayer-container`) 上的点击操作。

## ⚠️ 注意事项

*   请勿设置过短的发送间隔（建议 > 5秒），否则可能导致账号被抖音风控或禁言。
*   点赞功能依赖于页面布局，如果抖音更新了播放器结构，可能需要调整代码。
*   运行过程中请保持终端窗口开启（如果是在终端运行的话）。
